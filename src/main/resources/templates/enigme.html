<!DOCTYPE HTML>
<html xmlns:th="https://www.thymeleaf.org">
<head>
  <title>Enigme Qualité de Développement</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>Enigme Dev Web</title>
<!--  <link rel="stylesheet" href="/style.css">-->
  <link rel="stylesheet" href="/app.css">

  <link rel="script" href="/script.js">
</head>
<body>
<header class="header">
  <nav class="navbar">

    <a class="navbar-brand" href="#">
      <img class="imageLogo " src="/images/LogoSansNom.svg" alt="Logo" height=50px>
    </a>
    <p class="titreHeader" >ENIGMATICA</p>
  </nav>
</header>

<div class="boite">
<div class="enigmeDiv" id="enigmeDiv">
  <h1 class="titreEnigme">cc</h1>
  <div id="divid" style="position:relative"><img src="/images/codesmell.PNG" class="image" alt="code smell" th:src="@{images/codesmell.PNG}" usemap="#smell"></div>

  <map name="smell">
    <area id="lineToPrint" shape="rect" coords="150,96,261,115" alt="lineToPrint">
    <area id="lineToPrint2" shape="rect" coords="262 , 116, 385 , 137" alt="lineToPrint">
    <area id="casseClass" shape="rect" coords="132 , 6, 228 , 26" alt="casseClass">
    <area id="casseMethod" shape="rect" coords="162 , 76, 235 , 93" alt="casseMethod">
    <area id="number" shape="rect" coords="767 , 95, 782 , 113" alt="number">
  </map>



  <br/><br/> Coordonnées de la souris :<br/>
  <input type="text" name="regcoords" id="regcoords" />
  <div id="coords">Coords</div>
</div>
</div>
<script type="text/javascript">

var lineToPrint = document.getElementById('lineToPrint');
var lineToPrint2 = document.getElementById('lineToPrint2');
var magicNumber = document.getElementById('number');
var casseClass = document.getElementById('casseClass');
var casseMethod = document.getElementById('casseMethod');
var score = 0;

var divid = document.getElementById('divid');

lineToPrint.onclick = function(e) {
  // Obtenir les coordonnées de l'area cliquée
  lineToPrint.onclick = null;
  var coords = this.getAttribute('coords').split(',');
  var x1 = parseInt(coords[0]);
  var y1 = parseInt(coords[1]);
  var x2 = parseInt(coords[2]);
  var y2 = parseInt(coords[3]);
  var width = x2 - x1;
  var height = y2 - y1;

  // Créer le canvas et le placer sur l'image
  var canvas = document.createElement('canvas');
  canvas.width = width;
  canvas.height = height;
  canvas.style.position = 'absolute';
  canvas.style.left = x1 + 'px';
  canvas.style.top = y1 + 'px';
  divid.appendChild(canvas);

  // Tracer le rectangle sur le canvas
  var ctx = canvas.getContext('2d');
  ctx.fillStyle = 'rgba(255, 0, 0,0.5)';
  ctx.fillRect(0, 0, width, height);
  score++;
  if (score === 5) {
    window.location.href = "/result"


  }
};

lineToPrint2.onclick = function(e) {
  lineToPrint2.onclick = null;
  // Obtenir les coordonnées de l'area cliquée
  var coords = this.getAttribute('coords').split(',');
  var x1 = parseInt(coords[0]);
  var y1 = parseInt(coords[1]);
  var x2 = parseInt(coords[2]);
  var y2 = parseInt(coords[3]);
  var width = x2 - x1;
  var height = y2 - y1;

  // Créer le canvas et le placer sur l'image
  var canvas = document.createElement('canvas');
  canvas.width = width;
  canvas.height = height;
  canvas.style.position = 'absolute';
  canvas.style.left = x1 + 'px';
  canvas.style.top = y1 + 'px';
  divid.appendChild(canvas);

  // Tracer le rectangle sur le canvas
  var ctx = canvas.getContext('2d');
  ctx.fillStyle = 'rgba(255, 0, 0,0.5)';
  ctx.fillRect(0, 0, width, height);
  score++;
  if (score === 5) {
    window.location.href = "/result"


  }
};

magicNumber.onclick = function(e) {
    magicNumber.onclick = null;
  // Obtenir les coordonnées de l'area cliquée
  var coords = this.getAttribute('coords').split(',');
  var x1 = parseInt(coords[0]);
  var y1 = parseInt(coords[1]);
  var x2 = parseInt(coords[2]);
  var y2 = parseInt(coords[3]);
  var width = x2 - x1;
  var height = y2 - y1;

  // Créer le canvas et le placer sur l'image
  var canvas = document.createElement('canvas');
  canvas.width = width;
  canvas.height = height;
  canvas.style.position = 'absolute';
  canvas.style.left = x1 + 'px';
  canvas.style.top = y1 + 'px';
  divid.appendChild(canvas);

  // Tracer le rectangle sur le canvas
  var ctx = canvas.getContext('2d');
  ctx.fillStyle = 'rgba(255, 0, 0,0.5)';
  ctx.fillRect(0, 0, width, height);
  score++;
  if (score === 5) {
    window.location.href = "/result"


  }
};

casseClass.onclick = function(e) {
  casseClass.onclick = null;
  // Obtenir les coordonnées de l'area cliquée
  var coords = this.getAttribute('coords').split(',');
  var x1 = parseInt(coords[0]);
  var y1 = parseInt(coords[1]);
  var x2 = parseInt(coords[2]);
  var y2 = parseInt(coords[3]);
  var width = x2 - x1;
  var height = y2 - y1;

  // Créer le canvas et le placer sur l'image
  var canvas = document.createElement('canvas');
  canvas.width = width;
  canvas.height = height;
  canvas.style.position = 'absolute';
  canvas.style.left = x1 + 'px';
  canvas.style.top = y1 + 'px';
  divid.appendChild(canvas);

  // Tracer le rectangle sur le canvas
  var ctx = canvas.getContext('2d');
  ctx.fillStyle = 'rgba(255, 0, 0,0.5)';
  ctx.fillRect(0, 0, width, height);
    score++;
  if (score === 5) {
    window.location.href = "/result"
  }
};

casseMethod.onclick = function(e) {
    casseMethod.onclick = null;
  // Obtenir les coordonnées de l'area cliquée
  var coords = this.getAttribute('coords').split(',');
  var x1 = parseInt(coords[0]);
  var y1 = parseInt(coords[1]);
  var x2 = parseInt(coords[2]);
  var y2 = parseInt(coords[3]);
  var width = x2 - x1;
  var height = y2 - y1;

  // Créer le canvas et le placer sur l'image
  var canvas = document.createElement('canvas');
  canvas.width = width;
  canvas.height = height;
  canvas.style.position = 'absolute';
  canvas.style.left = x1 + 'px';
  canvas.style.top = y1 + 'px';
  divid.appendChild(canvas);

  // Tracer le rectangle sur le canvas
  var ctx = canvas.getContext('2d');
  ctx.fillStyle = 'rgba(255, 0, 0,0.5)';
  ctx.fillRect(0, 0, width, height);
  score++;
  if (score === 5) {
    window.location.href = "/result"
  }
};

window.addEventListener('resize', function() {
  // Recalculer les coordonnées de l'area cliquée
  var coords = document.getElementById('lineToPrint').getAttribute('coords').split(',');
  var x1 = parseInt(coords[0]);
  var y1 = parseInt(coords[1]);
  var x2 = parseInt(coords[2]);
  var y2 = parseInt(coords[3]);

  // Calculer les nouvelles dimensions et positions du canvas
  var width = x2 - x1;
  var height = y2 - y1;
  var canvas = document.getElementById('canvas');
  var rect = canvas.getBoundingClientRect();
  var scaleX = canvas.width / rect.width;
  var scaleY = canvas.height / rect.height;
  var newLeft = x1 - rect.left;
  var newTop = y1 - rect.top;
  var newWidth = width / scaleX;
  var newHeight = height / scaleY;

  // Mettre à jour les styles du canvas
  canvas.style.left = newLeft + 'px';
  canvas.style.top = newTop + 'px';
  canvas.width = newWidth;
  canvas.height = newHeight;

  // Redessiner le rectangle sur le canvas
  var ctx = canvas.getContext('2d');
  ctx.fillStyle = 'rgba(255, 0, 0,0.5)';
  ctx.fillRect(0, 0, newWidth, newHeight);
});

  /*
   Here add the ID of the HTML elements for which to show the mouse coords
   Within quotes, separated by comma.
   E.g.:   ['imgid', 'divid'];
  */
  var elmids = ['divid'];

  var x, y = 0;       // variables that will contain the coordinates

  // Get X and Y position of the elm (from: vishalsays.wordpress.com)
  function getXYpos(elm) {
    x = elm.offsetLeft;        // set x to elm’s offsetLeft
    y = elm.offsetTop;         // set y to elm’s offsetTop

    elm = elm.offsetParent;    // set elm to its offsetParent

    //use while loop to check if elm is null
    // if not then add current elm’s offsetLeft to x
    //offsetTop to y and set elm to its offsetParent
    while(elm != null) {
      x = parseInt(x) + parseInt(elm.offsetLeft);
      y = parseInt(y) + parseInt(elm.offsetTop);
      elm = elm.offsetParent;
    }

    // returns an object with "xp" (Left), "=yp" (Top) position
    return {'xp':x, 'yp':y};
  }

  // Get X, Y coords, and displays Mouse coordinates
  function getCoords(e) {
    // coursesweb.net/
    var xy_pos = getXYpos(this);

    // if IE
    if(navigator.appVersion.indexOf("MSIE") != -1) {
      // in IE scrolling page affects mouse coordinates into an element
      // This gets the page element that will be used to add scrolling value to correct mouse coords
      var standardBody = (document.compatMode == 'CSS1Compat') ? document.documentElement : document.body;

      x = event.clientX + standardBody.scrollLeft;
      y = event.clientY + standardBody.scrollTop;
    }
    else {
      x = e.pageX;
      y = e.pageY;
    }

    x = x - xy_pos['xp'];
    y = y - xy_pos['yp'];

    // displays x and y coords in the #coords element
    document.getElementById('coords').innerHTML = 'X= '+ x+ ' ,Y= ' +y;
  }

  // register onmousemove, and onclick the each element with ID stored in elmids
  for(var i=0; i<elmids.length; i++) {
    if(document.getElementById(elmids[i])) {
      // calls the getCoords() function when mousemove
      document.getElementById(elmids[i]).onmousemove = getCoords;

      // execute a function when click
      document.getElementById(elmids[i]).onclick = function() {
        document.getElementById('regcoords').value = x+ ' , ' +y;
      };
    }
  }
</script>

<!--<form class="enigmeDiv" action="#" th:action="@{/result}" th:object="${enigme}" method="post" onsubmit="return validation()">-->
<!--  <h1 class="titreEnigme">Enigme cool</h1>-->
<!--  <p></p>-->
<!--  <p>Réponse: <input type="text" th:field="*{content}" /></p>-->
<!--  <p id="errorMessage"></p>-->
<!--  <button type="submit">Envoyer</button>-->
<!--</form>-->


<div class="figure">
  <img class="imageAssistante" src="images/assistante2.svg" alt="assistante" height="300px">
  <img id="assistanteIdee" class="imageAssistanteIdee" src="images/assistanteIdee.svg" alt="assistante" height="300px">
</div>
</body>
<script>
  function indiceF12(){
    alert('Trop de mots');
}
  document.getElementById('assistanteIdee').addEventListener('click', function(){
    indiceF12();
  });

  function validation(){

    var reponse = document.getElementById('content').value;
    var errorMessage = document.getElementById('errorMessage');

    if(reponse === 'test'){
      return true;
    }
    else{
      errorMessage.innerText = "Réponse incorrecte, réessayez !";
      return false;
    }
  }
</script>

</html>